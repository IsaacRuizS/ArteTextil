<div class="modal fade show d-block modal-backdrop-custom" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg modal-dialog-centered">

        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title fw-bold">{{ title }}</h5>
                <button class="btn-close" (click)="close.emit()"></button>
            </div>

            <div class="modal-body">

                @if (errorMsg) {
                <div class="alert alert-danger">{{ errorMsg }}</div>
                }

                <!-- Nombre -->
                <label class="form-label fw-semibold">Nombre *</label>
                <input class="form-control mb-3" [(ngModel)]="form.name">

                <!-- Precio -->
                <label class="form-label fw-semibold">Precio *</label>
                <input type="number" class="form-control mb-3" [(ngModel)]="form.price">

                <!-- Stock -->
                <label class="form-label fw-semibold">Stock *</label>
                <input type="number" class="form-control mb-3" [(ngModel)]="form.stock">

                <!-- Categoría -->
                <label class="form-label fw-semibold">Categoría *</label>
                <select class="form-select mb-3" [(ngModel)]="form.category">
                    <option value="">Seleccione</option>
                    @for (c of categories; track c) {
                    <option [value]="c">{{ c }}</option>
                    }
                </select>

                <!-- Estado -->
                <label class="form-label fw-semibold">Estado</label>
                <select class="form-select mb-3" [(ngModel)]="form.status">
                    <option>Activo</option>
                    <option>Inactivo</option>
                    <option>Oculto</option>
                </select>

                <!-- Materiales -->
                <label class="form-label fw-semibold">Materiales</label>

                <div class="materials-list mb-3">
                    @for (m of materials; track m) {
                    <button class="btn btn-outline-secondary btn-sm me-2 mb-2"
                        [class.active-material]="form.materials.includes(m)" (click)="toggleMaterial(m)">
                        {{ m }}
                    </button>
                    }
                </div>

                <!-- Imágenes -->
                <label class="form-label fw-semibold">Imágenes del producto</label>
                <input type="file" multiple accept="image/*" (change)="onImagesSelected($event)"
                    class="form-control mb-3">

                <div class="image-preview-list">
                    @for (img of form.images; track img) {
                    <img [src]="img" class="preview-img">
                    }
                </div>

            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" (click)="close.emit()">Cancelar</button>

                <!-- Crear o Modificar -->
                @if (product) {
                <button class="btn btn-primary" (click)="save()">Guardar cambios</button>
                } @else {
                <button class="btn btn-primary" (click)="save()">Crear producto</button>
                }
            </div>

        </div>
    </div>
</div>